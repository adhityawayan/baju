var FormWizard=function(){return{init:function(){if(jQuery().bootstrapWizard){var a=$("#submit_form"),i=$(".alert-danger",a),t=$(".alert-success",a);a.validate({doNotHideMessage:!1,errorElement:"span",errorClass:"help-block help-block-error",focusInvalid:!1,rules:{transaksi_customer:{required:!0},transaksi_tanggal_masuk:{required:!0},transaksi_tanggal_selesai:{required:!0},transaksi_tipe_pembayaran:{required:!0}},errorPlacement:function(a,i){"transaksi_customer"==i.attr("name")?a.insertAfter("#customer_error"):"transaksi_tipe_pembayaran"==i.attr("name")?a.insertAfter("#transaksi_tipe_pembayaran_error"):a.insertAfter(i)},invalidHandler:function(){t.hide(),i.show(),App.scrollTo(i,-200)},highlight:function(a){$(a).closest(".form-group").removeClass("has-success").addClass("has-error")},unhighlight:function(a){$(a).closest(".form-group").removeClass("has-error")},success:function(a){a.addClass("valid").closest(".form-group").removeClass("has-error").addClass("has-success")},submitHandler:function(a){i.hide(),a[0].submit()}});var s=function(){$("#tab4 .form-control-static",a).each(function(){var i=$('[name="'+$(this).attr("data-display")+'"]',a);if(i.is(":radio")&&(i=$('[name="'+$(this).attr("data-display")+'"]:checked',a)),i.is(":text")||i.is("textarea"))"transaksi_dp"==$(this).attr("data-display")?null==i.val()||""==i.val()?$(this).html("-"):$(this).html(toRp(i.val())):$(this).html(i.val());else if(i.is("select"))$(this).html(i.find("option:selected").text());else if(i.is(":radio")&&i.is(":checked"))$(this).html(i.attr("data-title"));else if("item-display"==$(this).attr("data-display")){var t=[];$('[class="m_tipe_id"]:checked',a).each(function(a){var i=a+1,s="<tr>",r='<td class="text-center">'+i+"</td>",n="<td>"+$(this).data("title")+"</td>",e='<td class="text-center">'+$(this).siblings(".qty-hide").find("input.transaksi_quantity").val()+"</td>",o="<td>"+$(this).siblings(".qty-hide").find("input.transaksi_harga").val()+"</td>",l="<td>"+$(this).siblings(".qty-hide").find(".transaksi_catatan").val()+"</td>",d="</tr>";t.push(s),t.push(r),t.push(n),t.push(e),t.push(l),t.push(o),t.push(d)}),$(this).html(t.join(""))}})},r=function(a,i,t){var r=i.find("li").length,n=t+1;$(".step-title",$("#form_wizard_1")).text("Step "+(t+1)+" of "+r),jQuery("li",$("#form_wizard_1")).removeClass("done");for(var e=i.find("li"),o=0;t>o;o++)jQuery(e[o]).addClass("done");1==n?$("#form_wizard_1").find(".button-previous").hide():$("#form_wizard_1").find(".button-previous").show(),n>=r?($("#form_wizard_1").find(".button-next").hide(),$("#form_wizard_1").find(".button-submit").show(),s()):($("#form_wizard_1").find(".button-next").show(),$("#form_wizard_1").find(".button-submit").hide()),App.scrollTo($(".page-title"))};$("#form_wizard_1").bootstrapWizard({nextSelector:".button-next",previousSelector:".button-previous",onTabClick:function(a,i,t,s){return!1},onNext:function(s,n,e){return t.hide(),i.hide(),0==a.valid()?!1:(r(s,n,e),void 0)},onPrevious:function(a,s,n){t.hide(),i.hide(),r(a,s,n)},onTabShow:function(a,i,t){var s=i.find("li").length,r=t+1,n=r/s*100;$("#form_wizard_1").find(".progress-bar").css({width:n+"%"})}}),$("#form_wizard_1").find(".button-previous").hide(),$("#form_wizard_1").find(".button-submit").hide(),$(".transaksi_customer").bind("change",function(){$.ajax({url:$base_url+"transaksi/customer/"+$(".transaksi_customer").val(),dataType:"json",success:function(a){$.each(a,function(a,i){"customer_card"==i.field?$("#customer_card").val(i.value):"customer_tanggal_lahir"==i.field?$("#customer_tanggal_lahir").val(i.value):"customer_handphone"==i.field?$("#customer_handphone").val(i.value):"customer_alamat"==i.field?$("#customer_alamat").val(i.value):"diskon_tipe"==i.field?($("#diskon_tipe").html(i.value),$(".transaksi_diskon_tipe").val(i.value)):"diskon_persen"==i.field?$(".transaksi_diskon_persen").val(i.value):"diskon_persen_view"==i.field?$("#diskon_persen_view").html(i.value):($("#customer_card").val(""),$("#customer_tanggal_lahir").val(""),$("#customer_handphone").val(""),$("#customer_alamat").val(""),$("#diskon_tipe").html(""),$(".transaksi_diskon_tipe").val(""),$(".transaksi_diskon_persen").val(""),$("#diskon_persen_view").html(""))})}})}),$(".m_tipe_id").removeAttr("checked"),$(".m_tipe_id").siblings(".qty-hide").slideUp(),$(".transaksi_quantity").val(""),$(".transaksi_harga").val(""),$(".m_tipe_id_label").each(function(){{var a=$(this),i=$(this).find(".m_tipe_id"),t=$(this).find(".transaksi_quantity");$(".transaksi_category").val(),a.data("id")}i.removeAttr("checked"),t.val("")}),$(".m_tipe_id").on("click",function(){$parent_box=$(this).siblings(".qty-hide"),$parent_box.slideToggle(100),$(this).each(function(){$(this).is(":checked")||($(this).siblings(".qty-hide").find(".transaksi_quantity").val(""),$(this).siblings(".qty-hide").find(".transaksi_harga").val(""),$(this).siblings(".qty-hide").find(".transaksi_catatan").val(""))})}),null==$(".transaksi_total")&&$(".transaksi_total_view").val(""),$(".transaksi_quantity").bind("change",function(){var a=$(this).parents(".form-group"),i=$(this).val(),t=a.siblings(".form-group").find(".transaksi_harga").data("val");$val_qty_price=i*t,$val_qty_price_rp=toRp($val_qty_price),a.siblings(".form-group").find(".transaksi_harga").val($val_qty_price_rp),a.siblings(".form-group").find(".transaksi_harga").attr("data-val",$val_qty_price),transaksi_total()}),$(".transaksi_kartu_debit, .transaksi_kartu_kredit, .transaksi_tipe_cash, .transaksi_pengambilan").on("click",function(){var a=$(this).parent().siblings(".transaksi_tipe_w"),i=a.find(".form-group"),t=a.find("hr"),s=i.find(".transaksi_dp");i.hide(),t.hide(),s.val("");var r=$("body").find("#transaksi_total"),n=$("body").find(".transaksi_total_view"),e=$("body").find(".transaksi_subtotal").val(),o=$("body").find(".transaksi_diskon").val(),l=e-o-s.val();r.val(l),n.val(toRp(l))}),$(".transaksi_tipe_dp").siblings(".form-group").hide(),$(".transaksi_tipe_dp").siblings("hr").hide(),$(".transaksi_tipe_dp").on("click",function(){var a=$(this).siblings(".form-group"),i=$(this).siblings("hr");a.show(),i.show()}),$(".transaksi_dp").bind("change",function(){var a=$("body").find("#transaksi_total"),i=$("body").find(".transaksi_total_view"),t=$("body").find(".transaksi_subtotal").val(),s=$("body").find(".transaksi_diskon").val(),r=t-s-$(this).val();a.val(r),i.val(toRp(r))}),$(".transaksi_quantity").on("keyup",function(){var a=$(this).data("max"),i=$(this).val();i>a&&$(this).val(a)}),$("#return_tipe").on("change",function(){var a=$(this).val(),i=$("body").find("#return_tanggal_selesai");"rusak"==a?(i.find("input").val(""),i.siblings(".hr_return_tanggal_selesai").hide(),i.hide()):"kotor"==a&&(i.find("input").val(""),i.siblings(".hr_return_tanggal_selesai").show(),i.show())})}}}}();jQuery(document).ready(function(){FormWizard.init()});